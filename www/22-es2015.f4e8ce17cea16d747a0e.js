(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{gggo:function(t,e,i){"use strict";i.r(e),i.d(e,"SignPageModule",(function(){return g}));var s=i("ofXK"),n=i("3Pt+"),o=i("TEn/"),a=i("tyNb"),r=i("kOL3"),c=i("fXoL"),u=i("VGr1"),l=i("hq03");const b=["canvas"],d=[{path:"",component:(()=>{class t{constructor(t,e,i,s,n){this.service=t,this.alert=e,this.elementRef=i,this.router=s,this.route=n,this.update=!1,this.editImage=!1}ngOnInit(){this.getOpps()}getOpps(){this.service.showLoader();let t={opportunity_id:this.service.opportunity.OPPORTUNITY_ID,delete_status:"S"};console.log(t),this.service.postObs("/getdata/lead",t).subscribe(t=>{200==t.status&&(this.update=!0,this.signature=t.result[0].customer_sign,this.email=t.result[0].email,this.editImage=this.service.checkProperties({sign:this.signature}),console.log(this.editImage)),this.service.hideLoader()})}onResize(t){console.log(t),this.init()}editImagefun(){this.editImage=!this.editImage,this.update=!1}init(){this.elementRef.nativeElement.querySelector("canvas"),this.signaturePad&&this.signaturePad.clear()}ngAfterViewInit(){this.signaturePad=new r.a(this.signaturePadElement.nativeElement),this.signaturePad.clear(),this.signaturePad.penColor="rgb(51,190,229)"}isCanvasBlank(){if(this.signaturePad)return!!this.signaturePad.isEmpty()}clear(){this.signaturePad.clear()}undo(){const t=this.signaturePad.toData();t&&(t.pop(),this.signaturePad.fromData(t))}create(){if(this.service.showLoader(),this.signaturePad.toDataURL()){let t={opportunity_id:this.service.opportunity.OPPORTUNITY_ID,opportunity_user_id:this.service.opportunity.OWNER_USER_ID,customer_sign:this.signaturePad.toDataURL()};this.service.postObs("/postdata/lead",t).subscribe(t=>{this.service.hideLoader(),console.log(t),201==t.status?this.router.navigateByUrl("/home"):this.alert.presentToast("opportunity insert failed..!")})}}updateSign(){if(this.signaturePad.toDataURL()&&!this.editImage){let t={opportunity_id:this.service.opportunity.OPPORTUNITY_ID,customer_sign:this.signaturePad.toDataURL()};this.service.postObs("/putdata/lead",t).subscribe(t=>{this.service.hideLoader(),console.log(t),201==t.status?(this.router.navigateByUrl("/home"),""==this.signature&&null==this.signature&&null==this.signature&&this.pdfGen()):this.router.navigateByUrl("/home")})}else this.router.navigateByUrl("/home")}pdfGen(){this.service.showLoader(),this.service.postObs("/pdfCreate",{opportunity_id:this.service.opportunity.OPPORTUNITY_ID}).subscribe(t=>{console.log(t),this.service.hideLoader(),200==t.status?this.sendMail():this.alert.presentToast("Pdf generate failed")})}sendMail(){this.service.showLoader(),this.service.postObs("/sendMail",{toEmail:this.email,opportunity:this.service.mailData,userdata:this.service.userdata}).subscribe(t=>{this.service.hideLoader(),this.alert.presentToast(200==t.status?"Mail sent":"Mail sending failed..."),console.log(t)})}skip(){this.router.navigateByUrl("/home")}}return t.\u0275fac=function(e){return new(e||t)(c.Hb(u.a),c.Hb(l.a),c.Hb(c.l),c.Hb(a.g),c.Hb(a.a))},t.\u0275cmp=c.Bb({type:t,selectors:[["app-sign"]],viewQuery:function(t,e){var i;1&t&&c.hc(b,!0),2&t&&c.bc(i=c.Tb())&&(e.signaturePadElement=i.first)},hostBindings:function(t,e){1&t&&c.Sb("resize",(function(t){return e.onResize(t)}),!1,c.dc)},decls:30,vars:3,consts:[["slot","start"],[1,"signature-pad",3,"ngClass"],[1,"align-center"],[1,"sign_label"],["width","360","height","220",1,"signature-pad-canvas",2,"touch-action","none"],["canvas",""],["color","light","expand","full","size","4",3,"click"],["width","360","height","220",3,"src"],["expand","full","color","secondary",1,"button_pos",3,"click"],["lines","none",1,"ion-float-right"],["expand","block","color","secondary",3,"click"],["type","submit","expand","full","color","secondary",1,"footer_btn",3,"click"]],template:function(t,e){1&t&&(c.Kb(0,"ion-header"),c.Kb(1,"ion-toolbar"),c.Kb(2,"ion-buttons",0),c.Ib(3,"ion-back-button"),c.Jb(),c.Kb(4,"ion-title"),c.jc(5,"Sign"),c.Jb(),c.Jb(),c.Jb(),c.Kb(6,"ion-content"),c.Kb(7,"ion-item",1),c.Kb(8,"ion-row",2),c.Kb(9,"ion-label",3),c.jc(10,"Signature"),c.Jb(),c.Ib(11,"canvas",4,5),c.Kb(13,"ion-button",6),c.Sb("click",(function(){return e.undo()})),c.jc(14," Undo"),c.Jb(),c.Kb(15,"ion-button",6),c.Sb("click",(function(){return e.clear()})),c.jc(16," Clear"),c.Jb(),c.Jb(),c.Jb(),c.Kb(17,"ion-item",1),c.Kb(18,"ion-row",2),c.Kb(19,"ion-label",3),c.jc(20,"Signature"),c.Jb(),c.Ib(21,"img",7),c.Kb(22,"ion-button",8),c.Sb("click",(function(){return e.editImagefun()})),c.jc(23," Edit"),c.Jb(),c.Jb(),c.Jb(),c.Kb(24,"ion-item",9),c.Kb(25,"ion-button",10),c.Sb("click",(function(){return e.pdfGen()})),c.jc(26,"send quote"),c.Jb(),c.Jb(),c.Jb(),c.Kb(27,"ion-footer"),c.Kb(28,"ion-button",11),c.Sb("click",(function(){return e.updateSign()})),c.jc(29,"Submit"),c.Jb(),c.Jb()),2&t&&(c.xb(7),c.Zb("ngClass",e.editImage?"hideClass":""),c.xb(10),c.Zb("ngClass",e.editImage?"":"hideClass"),c.xb(4),c.Zb("src",e.signature,c.fc))},directives:[o.p,o.N,o.g,o.c,o.d,o.M,o.k,o.t,s.i,o.D,o.u,o.f,o.o],styles:[".signature-pad[_ngcontent-%COMP%]{background:#fff;border:1px solid #33bee5!important;margin-top:0}.hideClass[_ngcontent-%COMP%]{display:none}.margin_set[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{width:100%;background:none;color:#000;border:1px solid #33bee5;float:left;margin:2px 0}.badgeColor[_ngcontent-%COMP%]{background:#33bee5!important}.label_color[_ngcontent-%COMP%]{color:#9e9e9e}.button_pos[_ngcontent-%COMP%]{position:absolute;right:0}.sign_label[_ngcontent-%COMP%]{position:absolute;width:100%;text-align:center}.lb-img[_ngcontent-%COMP%]{background:#fff}"]}),t})()}];let h=(()=>{class t{}return t.\u0275mod=c.Fb({type:t}),t.\u0275inj=c.Eb({factory:function(e){return new(e||t)},imports:[[a.i.forChild(d)],a.i]}),t})(),g=(()=>{class t{}return t.\u0275mod=c.Fb({type:t}),t.\u0275inj=c.Eb({factory:function(e){return new(e||t)},imports:[[s.b,n.a,o.O,h]]}),t})()}}]);