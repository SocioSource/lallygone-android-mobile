(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{XpXM:function(t,i,e){"use strict";e.r(i),e.d(i,"MainPageModule",(function(){return J}));var n=e("ofXK"),o=e("3Pt+"),s=e("TEn/"),b=e("tyNb"),c=e("fXoL"),a=e("VGr1"),r=e("hq03"),l=e("A7BC");function h(t,i){if(1&t&&(c.Kb(0,"ion-card"),c.Kb(1,"ion-card-content"),c.Kb(2,"ion-list",4),c.Kb(3,"ion-item",5),c.Kb(4,"span",6),c.Ib(5,"ion-icon",7),c.Jb(),c.Kb(6,"ion-label"),c.Kb(7,"h2"),c.Kb(8,"span"),c.jc(9,"Total"),c.Jb(),c.Kb(10,"ion-badge",8),c.jc(11),c.Jb(),c.Jb(),c.Jb(),c.Jb(),c.Jb(),c.Jb(),c.Jb()),2&t){const t=c.Ub();c.xb(11),c.kc(t.getTotal)}}function p(t,i){if(1&t&&(c.Kb(0,"ion-card"),c.Kb(1,"ion-card-content"),c.Kb(2,"ion-list",4),c.Kb(3,"ion-item",5),c.Kb(4,"span",6),c.Ib(5,"ion-icon",7),c.Jb(),c.Kb(6,"ion-label"),c.Kb(7,"h2"),c.Kb(8,"span"),c.jc(9,"Won"),c.Jb(),c.Kb(10,"ion-badge",8),c.jc(11),c.Jb(),c.Jb(),c.Jb(),c.Jb(),c.Jb(),c.Jb(),c.Jb()),2&t){const t=c.Ub();c.xb(11),c.kc(t.wonTotal)}}function u(t,i){if(1&t){const t=c.Lb();c.Kb(0,"ion-card"),c.Kb(1,"ion-card-content",9),c.Sb("click",(function(){c.ec(t);const i=c.Ub().$implicit;return c.Ub().leadPage(i.stage_id)})),c.Kb(2,"ion-list",4),c.Kb(3,"ion-item",5),c.Kb(4,"span",6),c.Ib(5,"ion-icon",7),c.Jb(),c.Kb(6,"ion-label"),c.Kb(7,"h2"),c.Kb(8,"span"),c.jc(9),c.Jb(),c.Kb(10,"ion-badge",8),c.jc(11),c.Jb(),c.Jb(),c.Jb(),c.Jb(),c.Jb(),c.Jb(),c.Jb()}if(2&t){const t=c.Ub().$implicit;c.xb(9),c.kc(t.stage_name),c.xb(2),c.kc(t.count)}}function g(t,i){if(1&t&&(c.Kb(0,"div"),c.ic(1,u,12,2,"ion-card",2),c.Jb()),2&t){const t=i.$implicit;c.xb(1),c.Zb("ngIf",t.count>0)}}const d=[{path:"",component:(()=>{class t{constructor(t,i,e,n){this.service=t,this.alert=i,this.router=e,this.menu=n,this.opportunityLists=[],this.pipelineStages=[],this.stageId="All",this.getTotal=0,this.wonTotal=0,this.shows=!1}ngOnInit(){this.getStages()}ionViewDidEnter(){this.menu.enable(!0)}doRefresh(t){setTimeout(()=>{t.target.complete(),this.getStages(),this.getTotal=0,this.wonTotal=0,this.shows=!1,this.opportunityLists=[],this.pipelineStages=[],this.stageId=""},1e3)}getStages(){this.service.pipelineStages=[],this.service.showLoader(),this.service.postObs("/callApi",{method:"GET",url:"https://api.insightly.com/v3.1/PipelineStages?count_total=false",data:!1,key:"Basic YmY0NGViN2QtMWFmYy00NjA4LTg4MDQtMGVhNWY4YTc4NTVh"}).subscribe(t=>{200==t.status&&t.result.forEach((t,i)=>{873118==t.PIPELINE_ID&&(this.service.pipelineStages.push(t),this.getLead(t,i))})})}getLead(t,i){this.opportunityLists=[];let e=0;this.service.postObs("/callApi",{method:"GET",url:null==t||"All"==t?"https://api.insightly.com/v3.1/Opportunities?brief=true&count_total=false":"https://api.insightly.com/v3.1/Opportunities/Search?field_name=STAGE_ID&field_value="+t.STAGE_ID+"&brief=false&count_total=false",data:!1,key:"Basic YmY0NGViN2QtMWFmYy00NjA4LTg4MDQtMGVhNWY4YTc4NTVh"}).subscribe(n=>{200==n.status?(n.result.filter(t=>{this.wonTotal+="WON"==t.OPPORTUNITY_STATE?1:0,e+="OPEN"==t.OPPORTUNITY_STATE?1:0}),this.getTotal+=n.result.length,this.opportunityLists.push({stage_id:t.STAGE_ID,stage_name:t.STAGE_NAME,count:e})):this.alert.presentToast("No more data"),0==i&&this.service.hideLoader(),this.shows=!0})}leadPage(t){console.log(t),this.service.st.set("stage_id",t),this.router.navigate(["home"])}}return t.\u0275fac=function(i){return new(i||t)(c.Hb(a.a),c.Hb(r.a),c.Hb(b.g),c.Hb(s.R))},t.\u0275cmp=c.Bb({type:t,selectors:[["app-main"]],decls:13,vars:3,consts:[["slot","fixed",3,"ionRefresh"],["pullingIcon","chevron-down-circle-outline","pullingText","Pull to refresh","refreshingSpinner","circles","refreshingText","Refreshing..."],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"no-col"],["lines","none",1,"no-col"],["slot","start"],["name","business",2,"font-size","22px"],["color","danger",1,"count_class"],[3,"click"]],template:function(t,i){1&t&&(c.Kb(0,"ion-header"),c.Kb(1,"ion-toolbar"),c.Kb(2,"ion-title"),c.jc(3,"Home"),c.Jb(),c.Jb(),c.Jb(),c.Kb(4,"ion-content"),c.Kb(5,"ion-refresher",0),c.Sb("ionRefresh",(function(t){return i.doRefresh(t)})),c.Ib(6,"ion-refresher-content",1),c.Jb(),c.ic(7,h,12,1,"ion-card",2),c.ic(8,p,12,1,"ion-card",2),c.ic(9,g,2,1,"div",3),c.Jb(),c.Kb(10,"ion-footer"),c.Kb(11,"ion-toolbar"),c.Ib(12,"app-footer"),c.Jb(),c.Jb()),2&t&&(c.xb(7),c.Zb("ngIf",i.shows),c.xb(1),c.Zb("ngIf",i.shows),c.xb(1),c.Zb("ngForOf",i.opportunityLists))},directives:[s.p,s.N,s.M,s.k,s.A,s.B,n.k,n.j,s.o,l.a,s.h,s.i,s.v,s.t,s.q,s.u,s.e],styles:[".card-content-ios[_ngcontent-%COMP%], .card-content-md[_ngcontent-%COMP%]{padding-top:0;padding-bottom:0}.count_class[_ngcontent-%COMP%]{text-align:right;position:absolute;right:0}.no-col[_ngcontent-%COMP%]{background:none}"]}),t})()}];let f=(()=>{class t{}return t.\u0275mod=c.Fb({type:t}),t.\u0275inj=c.Eb({factory:function(i){return new(i||t)},imports:[[b.i.forChild(d)],b.i]}),t})(),J=(()=>{class t{}return t.\u0275mod=c.Fb({type:t}),t.\u0275inj=c.Eb({factory:function(i){return new(i||t)},imports:[[n.b,o.a,s.O,f]]}),t})()}}]);